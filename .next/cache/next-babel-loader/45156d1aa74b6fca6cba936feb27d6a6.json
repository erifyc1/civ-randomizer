{"ast":null,"code":"import { MongoClient } from 'mongodb';\nexport default (async (req, res) => {\n  try {\n    const client = await MongoClient.connect('mongodb+srv://user:admin@cluster0-o6jvs.mongodb.net/test?retryWrites=true&w=majority', {\n      useUnifiedTopology: true\n    });\n    const db = client.db('civ');\n    res.setHeader('Access-Control-Allow-Origin', '*');\n\n    if (req.query.civ) {\n      res.status(200).json(await db.collection('civs').findOne({\n        name: req.query.civ\n      }));\n    } else {\n      res.status(200).json(db.collection('civs').find({}).toArray().map(civ => ({\n        name: civ.name,\n        icon: civ.icon\n      })));\n    }\n  } catch (err) {\n    console.log(err);\n    res.status(500).send('Error');\n  }\n});","map":{"version":3,"sources":["D:/Jason/programming/VS Code Workspace/react-tutorial/pages/api/index.js"],"names":["MongoClient","req","res","client","connect","useUnifiedTopology","db","setHeader","query","civ","status","json","collection","findOne","name","find","toArray","map","icon","err","console","log","send"],"mappings":"AAAA,SAASA,WAAT,QAA4B,SAA5B;AAEA,gBAAe,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AAClC,MAAI;AACH,UAAMC,MAAM,GAAG,MAAMH,WAAW,CAACI,OAAZ,CAAoB,sFAApB,EAA4G;AAChIC,MAAAA,kBAAkB,EAAE;AAD4G,KAA5G,CAArB;AAGA,UAAMC,EAAE,GAAGH,MAAM,CAACG,EAAP,CAAU,KAAV,CAAX;AAEAJ,IAAAA,GAAG,CAACK,SAAJ,CAAc,6BAAd,EAA6C,GAA7C;;AACA,QAAIN,GAAG,CAACO,KAAJ,CAAUC,GAAd,EAAmB;AAClBP,MAAAA,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,MAAML,EAAE,CAACM,UAAH,CAAc,MAAd,EAAsBC,OAAtB,CAA8B;AAAEC,QAAAA,IAAI,EAAEb,GAAG,CAACO,KAAJ,CAAUC;AAAlB,OAA9B,CAA3B;AACA,KAFD,MAEO;AACNP,MAAAA,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CACCL,EAAE,CACAM,UADF,CACa,MADb,EAEEG,IAFF,CAEO,EAFP,EAGEC,OAHF,GAIEC,GAJF,CAIOR,GAAD,KAAU;AAAEK,QAAAA,IAAI,EAAEL,GAAG,CAACK,IAAZ;AAAkBI,QAAAA,IAAI,EAAET,GAAG,CAACS;AAA5B,OAAV,CAJN,CADD;AAOA;AACD,GAlBD,CAkBE,OAAOC,GAAP,EAAY;AACbC,IAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACAjB,IAAAA,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBY,IAAhB,CAAqB,OAArB;AACA;AACD,CAvBD","sourcesContent":["import { MongoClient } from 'mongodb';\r\n\r\nexport default async (req, res) => {\r\n\ttry {\r\n\t\tconst client = await MongoClient.connect('mongodb+srv://user:admin@cluster0-o6jvs.mongodb.net/test?retryWrites=true&w=majority', {\r\n\t\t\tuseUnifiedTopology: true\r\n\t\t});\r\n\t\tconst db = client.db('civ');\r\n\r\n\t\tres.setHeader('Access-Control-Allow-Origin', '*');\r\n\t\tif (req.query.civ) {\r\n\t\t\tres.status(200).json(await db.collection('civs').findOne({ name: req.query.civ }));\r\n\t\t} else {\r\n\t\t\tres.status(200).json(\r\n\t\t\t\tdb\r\n\t\t\t\t\t.collection('civs')\r\n\t\t\t\t\t.find({})\r\n\t\t\t\t\t.toArray()\r\n\t\t\t\t\t.map((civ) => ({ name: civ.name, icon: civ.icon }))\r\n\t\t\t);\r\n\t\t}\r\n\t} catch (err) {\r\n\t\tconsole.log(err);\r\n\t\tres.status(500).send('Error');\r\n\t}\r\n};\r\n"]},"metadata":{},"sourceType":"module"}